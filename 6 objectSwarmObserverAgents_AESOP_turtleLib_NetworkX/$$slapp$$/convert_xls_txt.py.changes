--- convert_xls_txt.py	(original)
+++ convert_xls_txt.py	(refactored)
@@ -19,7 +19,7 @@
 except:
     w=open("WARNING.txt","r")
     for line in w:
-        print line,
+        print(line, end=' ')
     w.close()
     os.sys.exit(1)
 
@@ -41,7 +41,7 @@
           if  current=='macro':
               #print '          macro ', sh.cell_value(r,c+1) #test
               if book.sheet_names().count(sh.cell_value(r,c+1))==0:
-                  print "ERROR: sheet '"+sh.cell_value(r,c+1)+"' missing"
+                  print("ERROR: sheet '"+sh.cell_value(r,c+1)+"' missing")
                   turtle.bye() # does not create problems if the graphic space is missing
                   os.sys.exit(1)
               sh_macro=book.sheet_by_index(book.sheet_names()\
@@ -51,20 +51,20 @@
               rec=out_table(sh_macro, book,f,rec)
               if r>0:
                   if sh.cell_value(r-1,0)=="#": #New
-                    print >>f, "#",int(sh.cell_value(r-1,1))+tC() # a small addendum
+                    print("#",int(sh.cell_value(r-1,1))+tC(), file=f) # a small addendum
                                                                   # to preserve order
 
                     #print "#",int(sh.cell_value(r-1,1)) #test
 
           else:
               if c==1 and sh.cell_value(r,0)=="#":
-                  print >>f, int(current)+tC(), # a small addendum
+                  print(int(current)+tC(), end=' ', file=f) # a small addendum
                                                # to preserve order
               else:
-                  print >>f, current,
+                  print(current, end=' ', file=f)
           if current=='macro': break
       if current != 'macro' and c != 0:
-          print >>f
+          print(file=f)
           #print #test
     #print '          finish ', rec # test
     rec-=1 # measure of recursion, for tests
@@ -79,7 +79,7 @@
  book = xlrd.open_workbook(project+"/schedule.xls")
  sh = book.sheet_by_index(0)
  if book.sheet_names()[0] != "schedule":
-     print "Error, first sheet in schedule.txt has to be named 'schedule'"
+     print("Error, first sheet in schedule.txt has to be named 'schedule'")
      turtle.bye()
      os.sys.exit(1)
  out_table(sh,book,f,1)
@@ -145,8 +145,8 @@
      if ll[i][0]==sharp: pass
      else:
          sharp=ll[i][0]
-         print >>f, '#', sharp
+         print('#', sharp, file=f)
 
      for j in range(1,len(ll[i])):
-         print >>f, ll[i][j]
+         print(ll[i][j], file=f)
  f.close()
